# deploy_file_server.yml
---
- hosts: file_server
  become: yes
  become_method: sudo
  pre_tasks:
    - name: Install libselinux-python
      yum:
        name: libselinux-python
        state: latest

  roles:
    - {role: puppet_disable, when: "disable_puppet"}
    - iptables
    - epel
    - ntp
    - glusterfs
    - {role: log-courier, when: "install_logstash"}
    - odbc

  tasks:
    # These commands won't work in Dockerr
    #- name: Create the Filesystem
    #  filesystem:
    #    fstype: ext4
    #    dev: /dev/sdb

    #- name: Mount volume
    #  mount:
    #    name: /data
    #    src: /dev/sdb
    #    fstype: ext4
    #    state: mounted

    - name: Ensure directories exist
      file:
        state: directory
        dest: /data/{{ item }}
      with_items: shared_folders
